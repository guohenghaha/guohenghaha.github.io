---
layout: page
title: arts 09 
permalink: /arts-09/
---

### 避免优化不存在的问题

工程师在解决问题的时候，有时候会陷入牛角尖，花很大的精力去优化一个问题。其实有的时候需要跳出来思考，这个问题是不是需要解决的，这个问题本质上是怎么产生的，在其他地方（比如上游）去处理是否更好解决呢？只有这样多去思考，才更有可能产出更加简洁可维护的方案，事半功倍。

比如我们在识别抢稀缺商品的用户，之前的方案是在用户下单之后判断用户购买行为算一个数来计算（当然还有其他叠加策略，这里不便说了），但是用户如果伪造很多小号，还是可能抢到稀缺商品，如果这个时候顺着之前的思考，可能是怎么在之前的方案之上去优化提防小号，这样的方案大概率会和之前的策略叠加，让整体的策略变得更加复杂。

是否可以换个思路，这些用户大概率会采用某种手段刷，如果我们在这个阶段而非到结算步骤去识别是否更好呢，还可以借助团队中以后的爬虫识别的技术。

### API spec 作为 source of truce 

和前端联调的时候偶尔会发现 API 没有按照和前端约定的返回，比如有的字段应该是驼峰，但是 python 写顺了会容易写成下划线的形式，这种返工有没有办法避免呢？

依赖后端仔细检查？不可，有的 API 字段太多，肉眼很难一下发现错误。

所以考虑引入 openapi 规范，工作流应该是首先前后端共同约定好 API spec，然后 mock server 根据 spec 生成模拟数据，前端可以来开发了。

同时，根据 spec 生成后端用的 Request/Response Validator(可能采用 marshmallow 来做，因为团队有人在调研了)，这样在接收到前端给的请求参数之后可以验证参数是否合法，同时在返回给前端之前也要通过 Response Validator 做验证和序列化。

参考: [构建下一代 HTTP API - 零成本抽象做输入输出的校验和正规化]()